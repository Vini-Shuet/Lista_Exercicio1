<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista Exercicios</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <h1>Atividade 1</h1>
    <h2 class="titulo">Header</h2>
    <header>
        <nav>
            <li>Opcao 1</li>
            <li>Opcao 2</li>            
        </nav>
    
    </header>


    <h2 class="titulo">Section</h2>
    <section id="imagens">
       <img class="imagem" src="https://images.pexels.com/photos/997121/pexels-photo-997121.jpeg?auto=compress&cs=tinysrgb&w=400" alt="Gramado">
        <img class="imagem" src="https://images.pexels.com/photos/424436/pexels-photo-424436.jpeg?auto=compress&cs=tinysrgb&w=400" alt="Placa de video">
        <img class="imagem" src="https://images.pexels.com/photos/336948/pexels-photo-336948.jpeg?auto=compress&cs=tinysrgb&w=600" alt="Celular">
    </section>
    
    <h2>Mudar Cor do titulo</h2>
    <input type="button" value="Mudar cor do fundo" onclick="mudarCorFundo()">

    <h2>Adicionar item</h2>
    <div class="adicionar-item">
        <input type="text" id="itemInput">
        <button onclick="adicionarItem()">Adicionar o Item</button>
    </div>

    <ul id="listaItens"></ul>

    <h2>Botao que chama a API(Get)</h2>
    <input type="button" value="Chamar API" onclick="consumirAPI()">
    <div>
        <p>Mensagem API: <input type="text" id="API"></p>
    </div>
    <h3>Resposta do Servidor:</h3>
    <p id="resposta"></p>

    <h2>Formulario (Post)</h2>

    <form action="post" id="formulario">
        <label for="nome">Nome:</label>
        <input type="text" id="nome" name="nome" required>
        <br><br>

        <label for="email">E-mail:</label>
        <input type="email" id="email" name="email" required>
        <br><br>

        <button type="submit" onclick="enviarDadosAPI()">Enviar</button>
    </form>

    <h2>Exibir dados na tabela</h2>
    <button onclick="exibirDadados()">Carregar Dados</button>
    <table id="tabelaDeDados">
        <thead>
            <tr>
                <th>Nome</th>
                <th>Email</th>
                <th>Idade</th>
            </tr>
        </thead>
        <tbody>

        </tbody>
    </table>
    
    <footer id="footer">
        <h2 class="titulo_footer">Footer</h2>
        <div class="git">
            <img src="./imagens/211904_social_github_icon.png" alt="GitHub">
            <a class="link" href="https://github.com/Vini-Shuet?tab=repositories">Link para Github</a>
        </div>
            
    </footer>

</body>

    <script>
        function mudarCorFundo(){
            document.body.style.backgroundColor = 
            document.body.style.backgroundColor === "lightblue" ? "white" : "lightblue";
        }

       function adicionarItem(){
        let input = document.getElementById("itemInput");
            let lista = document.getElementById("listaItens");

            if (input.value.trim() !== "") {
                let novoItem = document.createElement("li");
                novoItem.textContent = input.value;

                novoItem.ondblclick = function() {
                    lista.removeChild(novoItem);
                };

                lista.appendChild(novoItem); 
                input.value = ""; 
            } else {
                alert("Digite algo antes de enviar");
            }
            
        }

        function consumirAPI(){
        fetch("http://demo5075096.mockable.io/lista_exercicio")
        .then(response => response.json())
        .then(data => tratarDados(data))
        .catch(error => console.log(error))
        }

        function tratarDados(data){
        console.log(data)
        document.getElementById("API").value = data.mensagem
        }

        function enviarDadosAPI(){
            document.getElementById("formulario").addEventListener("submit", async function(event) {
            event.preventDefault(); 

            let nome = document.getElementById("nome").value;
            let email = document.getElementById("email").value;

            let dados = {
                nome: nome,
                email: email
            };

            try {
                let response = await fetch("http://demo5075096.mockable.io/formulario", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(dados)
                });

                let respostaServidor = await response.json();

                document.getElementById("resposta").innerText = JSON.stringify(respostaServidor, null, 2);
                
            } catch (error) {
                document.getElementById("resposta").innerText = "Erro ao enviar os dados.";
                console.error("Erro:", error);
            }
        })
        }

        function exibirDadados() {
            fetch("http://demo5075096.mockable.io/listaUsuario")
            .then(response => response.json())

            .then(data => { 

            let corpoTabela = document.querySelector("#tabelaDeDados tbody");
            corpoTabela.innerHTML = "";

            data.forEach(user => {
                let linha = document.createElement("tr");

                linha.innerHTML = `
                    <td>${user.nome}</td>
                    <td>${user.email}</td>
                    <td>${user.idade}</td>`
                ;

                corpoTabela.appendChild(linha);
            });
        })
        .catch(error => console.error("Erro ao buscar os dados:", error));
        }

    </script>

</html>